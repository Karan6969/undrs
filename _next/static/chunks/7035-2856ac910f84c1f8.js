"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7035],{57035:function(e,t,r){r.r(t),r.d(t,{default:function(){return W},useSelectedPaymentProcessor:function(){return G}});var n=r(57437),s=r(16480),a=r.n(s),o=r(47907),l=r(2265),i=r(20888),c=r(17520),u=r(20703),d=r(84887),m=r(82670),p=r(71399),g=r(53573),f=r(37945);let h=(0,l.forwardRef)((e,t)=>{let r=e.iframeOrigin,s=e.onClick,a=e.processing,o=e.text,i=(0,l.useRef)(null),[c,u]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{let e=e=>{if("pay/iframe_button/ready"===e.data.type){console.log("controller ready");let e={type:"pay/iframe_button/ready_ack"};console.log("ack",e),i.current.contentWindow.postMessage(e,"*"),u(!0)}"pay/iframe_button/on_click"===e.data.type&&s()};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[s]),(0,l.useEffect)(()=>{r&&c&&i.current.contentWindow.postMessage({type:"pay/iframe_button/set_processing",processing:a},"*")},[a,r]),(0,l.useImperativeHandle)(t,()=>({redirect:e=>{r?!c||i.current.contentWindow.postMessage({type:"pay/iframe_button/redirect",url:e},"*"):window.top.location.href=e}})),r)?(0,n.jsxs)("div",{className:e.className,children:[!c&&(0,n.jsx)("div",{className:"text-md flex w-full animate-pulse items-center justify-center rounded-md border border-gray-200 bg-gray-600 py-2.5 text-white",children:"Loading"}),(0,n.jsx)("iframe",{id:"iframe-button",style:{height:c?"46px":"0px",width:"100%"},ref:i,scrolling:"no",src:"".concat(r,"/pay/iframe_button?text=").concat(o)})]}):(0,n.jsx)("div",{className:e.className,children:(0,n.jsxs)("button",{color:"blue",disabled:a,className:"text-md w-full rounded-md bg-blue-500 px-5 py-2.5 text-center font-bold text-white hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300",type:"button",onClick:s,children:[a&&(0,n.jsx)("span",{className:"me-3 inline-block h-5 w-5 align-middle text-white",children:(0,n.jsx)(f.frZ,{className:"h-full w-auto animate-spin"})}),(0,n.jsx)("span",{children:o})]})})});h.displayName="IframeButtonWrapper";var y=r(98955);let x={"Content-Type":"application/json",Authorization:"Basic cG9ybmdlbjpwb3JuZ2Vu"};function v(e,t){if(null!==t&&"null"!==t&&"undefined"!==t&&"None"!==t&&""!==t)return t}async function b(e){let t=new URL(window.location.href);for(let r of(t.searchParams.delete("auth"),e.metadata.payment_channel=t.toString(),["utm_source","utm_medium","utm_campaign","utm_content"])){let t=y.Z.get(r);t&&(e.metadata[r]=t)}let r=e.recurring_interval?"subscriptions":"purchase",n=await fetch("".concat("https://kkz3mmrmm6.us-east-1.awsapprunner.com","/").concat(r),{method:"POST",headers:x,body:JSON.stringify(e,v)});try{return await n.json()}catch(e){return console.error("create payment",e),{transaction_status:"FAILED",transaction_error_message:"Payment failed, please try a different payment method."}}}var w=r(16459),N=r.n(w),_=r(21666),j=r.n(_),P=r(30982);function E(e){let{cardType:t,supportedCard:r,...s}=e;return t?["american-express","discover","jcb","mastercard","unionpay","visa"].includes(t)?(0,n.jsx)("img",{src:"/payicon/cardlogo/".concat(t,".svg"),alt:t,"aria-hidden":"true",...s}):(0,n.jsx)(p.ypE,{...s}):r?(0,n.jsx)(n.Fragment,{children:r.filter(e=>e).map(e=>(0,n.jsx)("img",{src:"/payicon/cardlogo/".concat(e,".svg"),alt:e,"aria-hidden":"true",...s},e))}):void 0}let k="";function S(e){var t,r,s,f,y,x,v,w,_,S,C,A,I,D,R,T,M,F,L,O,U;let{processing:G,setProcessing:V}=e,{register:W,getValues:B,setValue:H,setError:Y,formState:{errors:z},resetField:J,clearErrors:Z,control:q}=(0,m.cI)({mode:"onChange"}),X=(0,o.useSearchParams)(),[Q,K]=(0,l.useState)(""),[$,ee]=(0,i.v1)("gl",i.Oi.withDefault("US")),et=["firstName","lastName","city","zipcode","address"],er=(0,P.useLocale)(),en=(0,P.useTranslations)("pay"),es=(0,g.usePaymentIntent)(),ea=(0,g.useCaptureUrl)(),eo=X.get("cd"),[el,ei]=(0,l.useState)(""),[ec,eu]=(0,l.useState)(!1),ed=X.get("rc"),em=(null===(t=X.get("sc"))||void 0===t?void 0:t.split(","))||[];em.push("");let ep=ed&&"DISABLED"!==ed?["visa","american-express","discover","jcb"]:[],eg=["AU","CA","FR","DE","MY","NL","NZ","SG","US","GB","CH",""].includes($),ef=Object.keys(c.hW).map(e=>({code:e,displayName:new Intl.DisplayNames([er],{type:"region"}).of(e)}));ef.sort((e,t)=>e.displayName.localeCompare(t.displayName,er));let eh=(0,l.useRef)(null),ey=(0,l.useRef)(null),ex=(0,l.useCallback)(async()=>{let e=B("cardNumber").replace(/\D/g,""),t=N().number(e),r=el;if(t.card&&(r=t.card.type,!em.includes(r)&&ep.includes(r))){console.log("using redirect card processor"),V(!0);let e=JSON.parse(JSON.stringify(es));e.cancel_url=window.location.href,e.success_url=ea,e.payment_processor=ed,e.metadata&&(e.metadata.card_type=r),console.log("payment request",e);let t=await b(e);if(console.log("response",t),(null==t?void 0:t.transaction_status)==="FAILED"){console.log("error from payment intent",null==t?void 0:t.transaction_error_message),K(null==t?void 0:t.transaction_error_message),V(!1);return}(null==t?void 0:t.checkout_url)&&(console.log("redirect to ",null==t?void 0:t.checkout_url),ey.current.redirect(t.checkout_url));return}if(!function(){let e=B("cardNumber").replace(/\D/g,""),t=N().number(e);if(!t.isValid||!t.card)return console.log("card not valid"),Y("root.cardValidation",{type:"cardNumber",message:"Invalid card number"}),!1;let r=B("expirationDate");if(!/^(0[1-9]|1[0-2])\/?([0-9]{2})$/.test(r))return Y("root.cardValidation",{type:"expirationDate",message:"Invalid expiration date MM/YY"}),!1;let n=r.split("/"),s=new Date(+n[1]+2e3,+n[0]);return s<new Date?(s.setMonth(s.getMonth()-1),Y("root.cardValidation",{type:"expirationDate",message:"Card expired ".concat(s.toLocaleDateString(void 0,{year:"numeric",month:"long"}))}),!1):B("cvc").length!=t.card.code.size?(Y("root.cardValidation",{type:"cvc",message:"Invalid cvc"}),!1):(Z("root.cardValidation"),!0)}()||!function(){let e=!0;for(let t of et){if("address"===t){eh.current.value?Z("root.address"):(Y("root.address",{type:"custom"}),e=!1);continue}B(t)?Z("root.".concat(t)):(Y("root.".concat(t),{type:"custom"}),console.log("root.".concat(t)),e=!1)}return e}())return;V(!0);let n=JSON.parse(JSON.stringify(es));n.cancel_url=window.location.href,n.success_url=ea;let s=eh.current;console.log("country",$),n.card_info={card_number:B("cardNumber"),card_type:r,expiry_date:B("expirationDate"),cvc:B("cvc"),first_name:B("firstName").trim(),last_name:B("lastName").trim(),billing_address_line_1:et.includes("address")?s.value.trim():void 0,billing_city:B("city"),billing_country_code:$,billing_zip_code:B("zipcode")},n.payment_processor=eo,console.log("payment request",n);let a=await b(n);if(console.log("response",a),(null==a?void 0:a.transaction_status)==="FAILED"){console.log("error from payment intent",null==a?void 0:a.transaction_error_message),K(null==a?void 0:a.transaction_error_message),V(!1);return}if(null==a?void 0:a.checkout_url){console.log("redirect to ",null==a?void 0:a.checkout_url),ey.current.redirect(a.checkout_url);return}if((null==a?void 0:a.transaction_status)==="SUCCEEDED"){K("Payment succeeded! Redirecting..."),a.success_url&&(window.top.location.href=a.success_url);return}},[$]);function ev(){return!!B("cardNumber")&&!!B("cvc")&&!!B("expirationDate")}return(0,n.jsxs)("form",{className:a()({"pointer-events-none":G}),children:[(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("legend",{className:"block text-sm font-medium leading-6 text-gray-900",children:en("Card information")}),(0,n.jsxs)("div",{className:"mt-2 -space-y-px rounded-md bg-white shadow-sm",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("label",{htmlFor:"card-number",className:"sr-only",children:en("Card number")}),(0,n.jsx)("input",{...W("cardNumber",{required:!0}),onInput:e=>(function(e){let t=e.replace(/\D/g,""),r=N().number(t);if(r.isPotentiallyValid)Z("root.cardValidation");else{Y("root.cardValidation",{type:"cardNumber",message:"Invalid card number"});return}if(r.card)ei(r.card.type),console.log(j().getTypeInfo(r.card.type));else{ei("");return}let n=r.card;if(n){for(var s=[].concat(0,n.gaps,t.length),a=[],o=0;s[o]<t.length;o++){var l=s[o],i=Math.min(s[o+1],t.length);a.push(t.substring(l,i))}H("cardNumber",a.join(" ")),eu(ev())}})(e.target.value),type:"tel",className:a()("form-input relative block w-full rounded-none rounded-t-md border-0 bg-transparent text-gray-900 ring-1 ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-7",{"bg-red-50 ring-red-500":(null===(s=z.root)||void 0===s?void 0:null===(r=s.cardValidation)||void 0===r?void 0:r.type)==="cardNumber","ring-inset":(null===(y=z.root)||void 0===y?void 0:null===(f=y.cardValidation)||void 0===f?void 0:f.type)!=="cardNumber"}),placeholder:"1234 1234 1234 1234"}),(0,n.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center gap-x-2 pr-3",children:(0,n.jsx)(E,{cardType:el,supportedCard:[...new Set(em.concat(ep))],className:"w-6"})})]}),(0,n.jsxs)("div",{className:"flex -space-x-px",children:[(0,n.jsxs)("div",{className:"w-1/2 min-w-0 flex-1",children:[(0,n.jsx)("label",{htmlFor:"card-expiration-date",className:"sr-only",children:en("Expiration")}),(0,n.jsx)("input",{...W("expirationDate",{required:!0}),onInput:e=>{let t;(t=(t=e.target.value.replace(/\D/g,"")).slice(0,4)).length<=2?H("expirationDate",t):H("expirationDate",t.slice(0,2)+"/"+t.slice(2)),eu(ev())},type:"tel",className:a()("form-input relative block w-full rounded-none rounded-bl-md border-0 bg-transparent text-gray-900 ring-1 ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-7",{"bg-red-50 ring-red-500":(null===(v=z.root)||void 0===v?void 0:null===(x=v.cardValidation)||void 0===x?void 0:x.type)==="expirationDate","ring-inset":(null===(_=z.root)||void 0===_?void 0:null===(w=_.cardValidation)||void 0===w?void 0:w.type)!=="expirationDate"}),placeholder:"MM / YY"})]}),(0,n.jsxs)("div",{className:"relative min-w-0 flex-1",children:[(0,n.jsx)("label",{htmlFor:"card-cvc",className:"sr-only",children:en("CVC")}),(0,n.jsx)("input",{...W("cvc",{required:!0}),onInput:e=>{H("cvc",e.target.value.replace(/\D/g,"").slice(0,4)),eu(ev())},type:"tel",className:a()("form-input relative block w-full rounded-none rounded-br-md border-0 bg-transparent text-gray-900 ring-1 ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-7",{"bg-red-50 ring-red-500":(null===(C=z.root)||void 0===C?void 0:null===(S=C.cardValidation)||void 0===S?void 0:S.type)==="cvc","ring-inset":(null===(I=z.root)||void 0===I?void 0:null===(A=I.cardValidation)||void 0===A?void 0:A.type)!=="cvc"}),placeholder:"CVC"}),(0,n.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center gap-x-2 pr-3",children:(0,n.jsx)(u.default,{src:"/payicon/cvc.svg",alt:"cvc",height:20,width:20,className:"w-auto","aria-hidden":"true"})})]})]})]}),(null===(D=z.root)||void 0===D?void 0:D.cardValidation)&&(0,n.jsxs)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-500",children:[null===(R=z.root)||void 0===R?void 0:R.cardValidation.message,"."]})]}),em.includes(el)&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-x-4 gap-y-3",children:[(0,n.jsxs)("div",{className:"col-span-1",children:[(0,n.jsx)("label",{htmlFor:"first-name",className:"block text-sm font-medium text-gray-700",children:en("First name")}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("input",{...W("firstName",{required:!0}),type:"text",autoComplete:"given-name",className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(T=z.root)||void 0===T?void 0:T.firstName})})})]}),(0,n.jsxs)("div",{className:"col-span-1",children:[(0,n.jsx)("label",{htmlFor:"last-name",className:"block text-sm font-medium text-gray-700",children:en("Last name")}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("input",{...W("lastName",{required:!0}),type:"text",autoComplete:"family-name",className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(M=z.root)||void 0===M?void 0:M.lastName})})})]}),et.includes("address")&&ec&&(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:en("Address")}),(0,n.jsx)("div",{className:"mt-1",children:eg?(0,n.jsx)(d.default,{ref:eh,placeholder:"",type:"text",name:"address",autoComplete:"street-address",apiKey:"AIzaSyAtziJsaF07iUp4LTxNcq1wg63txQMDglw",options:{types:[],componentRestrictions:{country:$}},onPlaceSelected:function(e){console.log(e);let t="",r="",n="",s="";for(let a of e.address_components)a.types.includes("postal_code")&&(t=a.short_name),(a.types.includes("locality")||a.types.includes("postal_town"))&&(r=a.short_name),a.types.includes("street_number")&&(n=a.short_name),a.types.includes("route")&&(s=a.short_name);console.log(n,s,r,t),r&&H("city",r),t&&H("zipcode",t),n&&s&&(eh.current.value=n+" "+s)},className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(F=z.root)||void 0===F?void 0:F.address})}):(0,n.jsx)("input",{ref:eh,type:"text",name:"address",autoComplete:"street-address",className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(L=z.root)||void 0===L?void 0:L.address})})})]}),et.includes("city")&&ec&&(0,n.jsxs)("div",{className:"col-span-1",children:[(0,n.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:en("City")}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("input",{...W("city",{required:!0}),type:"text",autoComplete:"address-level2",className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(O=z.root)||void 0===O?void 0:O.city})})})]}),et.includes("zipcode")&&ec&&(0,n.jsxs)("div",{className:"col-span-1",children:[(0,n.jsx)("label",{htmlFor:"postal-code",className:"block text-sm font-medium text-gray-700",children:en("Zip code")}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("input",{...W("zipcode",{required:!0}),type:"text",autoComplete:"postal-code",className:a()("form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",{"border-red-500 bg-red-50":null===(U=z.root)||void 0===U?void 0:U.zipcode})})})]}),(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:en("Country")}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("select",{required:!0,id:"country",name:"country",autoComplete:"country-name",value:$,onChange:e=>{ee(e.target.value)},className:"form-select block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-inset focus:ring-indigo-500 sm:text-sm",children:ef.map(e=>{let{code:t,displayName:r}=e;return(0,n.jsx)("option",{value:t,suppressHydrationWarning:!0,children:r},t)})})})]}),["undressai.tools"].includes(k)&&(0,n.jsx)("div",{className:"col-span-2 mt-3",children:(0,n.jsx)("div",{className:"flex items-start",children:(0,n.jsx)("div",{className:"text-sm leading-6 text-gray-500",children:(0,n.jsx)("p",{children:en("We understand the importance of your privacy, 'adult' related keywords won't appear on your bank statement")})})})})]})}),!em.includes(el)&&!ep.includes(el)&&(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsxs)("div",{className:"flex flex-row gap-x-4",children:[(0,n.jsx)(E,{supportedCard:em,className:"inline-block h-auto w-10",cardType:el}),j().getTypeInfo(el).niceType," ",en("card not supported, Please use:"),em.filter(e=>e).join(", "),"."]})}),ep.includes(el)&&!em.includes(el)&&(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex flex-row gap-x-4",children:[(0,n.jsx)(E,{supportedCard:em,className:"inline-block h-auto w-10",cardType:el}),en("Pay with")," ",j().getTypeInfo(el).niceType," ?"]}),(0,n.jsxs)("div",{className:"mt-4 flex flex-row gap-x-4 text-sm font-light text-gray-500",children:[(0,n.jsx)(p.HSQ,{className:"h-auto w-10"}),(0,n.jsxs)("div",{children:[j().getTypeInfo(el).niceType," ",en("card, please use this payment link")]})]})]}),(0,n.jsx)(h,{ref:ey,iframeOrigin:void 0,text:ep.includes(el)?"Pay with "+j().getTypeInfo(el).niceType:en("Pay now"),className:a()("mt-6",{"pointer-events-none":!em.includes(el)&&!ep.includes(el)}),processing:G,onClick:ex}),Q&&(0,n.jsx)("p",{className:"text-center text-red-600",children:Q})]})}k=new URL(window.location.href).hostname;var C=r(32153);let A=(0,C.cn)({key:"iframeUrlState",default:null}),I=(0,C.cn)({key:" showBackupButtonState",default:!1});function D(e){let{payment_processor:t}=e,r=(0,g.useCaptureUrl)(),s=(0,l.useRef)(null),a=(0,l.useRef)(null),c=(0,P.useTranslations)("pay"),u=(0,g.usePaymentIntent)(),[d,m]=(0,C.FV)(A),[h,y]=(0,C.FV)(I),[x,v]=(0,i.v1)("cd"),w=(0,o.useSearchParams)().get("bc"),[N,_]=(0,l.useState)(!1);async function j(){if("DIRECT"===w){v("DIRECT");return}console.log("using redirect card processor"),_(!0);let e=JSON.parse(JSON.stringify(u));e.cancel_url=window.location.href,e.success_url=r,e.payment_processor=w,console.log("payment request",e);let t=await b(e);if(console.log("response",t),(null==t?void 0:t.transaction_status)==="FAILED"){console.log("error from payment intent",null==t?void 0:t.transaction_error_message),_(!1);return}(null==t?void 0:t.checkout_url)&&(console.log("redirect to ",null==t?void 0:t.checkout_url),window.location.href=t.checkout_url)}return(0,l.useEffect)(()=>{if(d)return;let e=JSON.parse(JSON.stringify(u));e.cancel_url=window.location.href,e.success_url=r,e.payment_processor=t,b(e).then(e=>{m(e.checkout_url)})},[]),(0,l.useEffect)(()=>{if(h||"DISABLED"===w)return;let e=setTimeout(()=>{y(!0)},6e4);return()=>clearTimeout(e)},[]),(0,n.jsxs)(n.Fragment,{children:[h&&(0,n.jsxs)("button",{className:"mb-4 text-center text-lg text-gray-900",onClick:j,disabled:N,children:[c.rich("If the card payment cannot be completed, try",{link:e=>(0,n.jsx)("span",{className:"underline",children:e})}),(0,n.jsx)("span",{className:"ms-2 inline-block h-4 w-4 text-gray-900",children:N?(0,n.jsx)(f.frZ,{className:"h-full w-auto animate-spin"}):(0,n.jsx)(p.CkN,{className:"h-full w-auto "})})]}),(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsxs)("div",{className:"relative overflow-hidden",ref:s,style:{height:"700px",width:"390px"},children:[!d&&(0,n.jsx)("span",{className:"absolute left-1/2 top-10 -z-10 me-3 inline-block h-10 w-10 -translate-x-1/2 transform align-middle",children:(0,n.jsx)(f.frZ,{className:"h-full w-auto animate-spin",color:"#1c64f2"})}),d&&(0,n.jsx)("iframe",{ref:a,style:{marginTop:"".concat(-5,"px"),marginLeft:"".concat(-5,"px"),width:"".concat(400,"px"),height:"710px"},className:"w-full",scrolling:"no",role:"presentation",allow:"payment *; publickey-credentials-get *",src:d})]})})]})}function R(){let e=(0,P.useTranslations)("pay"),t=(0,g.useSelectedPaymentMethod)(),r=t.key;return(0,n.jsxs)("div",{className:"rounded-md border border-gray-200 p-4 shadow-sm",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)("div",{className:"h-8",children:t.icon}),(0,n.jsxs)("div",{className:"font-normal text-gray-700",children:[e(r)," - ",e("selected")]})]}),(0,n.jsx)("hr",{className:"mb-2 mt-2 h-px border-0 bg-gray-200"}),(0,n.jsxs)("div",{className:"flex flex-row gap-x-4 text-sm font-light text-gray-500",children:[(0,n.jsx)(p.CkN,{className:"h-10 w-10"}),(0,n.jsx)("div",{children:e("redirect_message")})]})]})}var T=r(21535);let M=["TOPPAY","UNIQ","POENAD","PAYPLAY","PSERV","PAYPORT","SURFGATE","SPEED","FTSOA","BAIWEI","BAIWEIW","APAY","OVERPAY","KESS","KESSC","KESSG","LUXA","XSPEND","XSPENDC"],F=["D"],L={};function O(e){var t;let{processing:r,setProcessing:s}=e,[a,o]=(0,l.useState)(""),i=(0,P.useTranslations)("pay"),c=(0,g.useCaptureUrl)(),u=(0,T.useCurrency)(),d=(0,g.usePaymentIntent)(),m=G(),p=L[m],f=(0,l.useRef)(null),y=null===(t=d.product_enum)||void 0===t?void 0:t.toLowerCase(),x=d.usd_amount;function v(e){let t=new URL(e);if(p){let e=new URL(p);t.protocol=e.protocol,t.host=e.host,t.port=e.port,t.searchParams.delete("view")}return t.pathname="/pay/".concat(y,"/").concat(x,"/"),console.log(d),t.toString()}async function w(){var e,t;if(s(!0),console.log(m),M.includes(m)){let t=JSON.parse(JSON.stringify(d));t.cancel_url=v(window.location.href),t.success_url=c,t.payment_processor=m,["SURFGATE","PAYPORT","PSERV","TOPPAY"].includes(m)&&(t.currency=u),console.log("payment request",t);let r=await b(t);if(console.log("payment response",r),r&&r.checkout_url&&(console.log(r.checkout_url),e=r.checkout_url),(null==r?void 0:r.transaction_status)==="FAILED"){console.log("error from payment intent",null==r?void 0:r.transaction_error_message),o(null==r?void 0:r.transaction_error_message),s(!1);return}}else if(F.includes(m)){let t=new URL(v(window.location.href));t.searchParams.set("selector","0"),t.searchParams.set("view","full"),e=t.toString()}else{let t=new URL(v(window.location.href));t.searchParams.set("view","full"),console.log(t),e=t.toString()}e.startsWith("http")?null===(t=f.current)||void 0===t||t.redirect(e):(document.write(e),document.close())}return console.log("capture url",c),(0,n.jsxs)("div",{children:[(0,n.jsx)(R,{}),(0,n.jsx)(h,{ref:f,iframeOrigin:p,text:i("Pay now"),className:"mt-6",processing:r,onClick:w}),a&&(0,n.jsx)("p",{className:"text-center text-red-600",children:a})]})}let U=["PAYWEB","HONGPAY","QUANTUM","BPNG","DIRECT"];function G(){let e=(0,o.useSearchParams)(),t=e.get("selected"),r=e.get("pp"),n=e.get("cd"),s=e.get("cd10");e.get("mo");let a=e.get("ct"),l=e.get("ap"),i=e.get("gg");if("card"===t)return n;if("card10"===t)return s;if("applepay"===t)return l;if("googlepay"===t)return i;if("paypal"===t)return r;if("crypto"==t)return a;if("sepa"===t)return"XSPEND";else if("alipay"===t)return"BAIWEI";else if("wechat"===t)return"BAIWEIW";else if(["gcash","touchngo","dana","kakaopay","truemoney","rabbitlinepay"].includes(t))return"AIRSECURE";else if(["tinkbankandsber","turkish_sber_tink","egypt_e_wallet","BDT"].includes(t))return"PAYPORT";else if(["upi","upiandimps"].includes(t))return"SURFGATE";else if(["upi","upiandimps","privatbankandmonobank"].includes(t))return"PSERV";else if(["spei"].includes(t))return"TOPPAY";else if(["pix"].includes(t))return"TOPPAY";return""}function V(e){let t=(0,o.useSearchParams)();t.get("selector");let r=t.get("view"),s=G();return["PPPP","BUY10"].includes(s)&&"full"===r?(0,n.jsx)(D,{payment_processor:s,...e}):U.includes(s)&&"full"===r?(0,n.jsx)(S,{...e}):(0,n.jsx)(O,{...e})}function W(){let e=(0,o.useSearchParams)().get("selector"),[t,r]=(0,i.v1)("selected"),[s,c]=(0,i.v1)("currency",i.Oi),[u,d]=(0,l.useState)(!1),m=(0,P.useTranslations)("pay"),p=(0,l.useRef)(null),f=(0,l.useRef)(null),[h,y]=(0,l.useState)(void 0),x=(0,g.usePaymentIntent)(),v=(0,g.useAllPaymentMethods)(),[b,w]=(0,l.useState)(!1),[N,_]=(0,i.v1)("cd");return x.usd_amount>100&&"UNIQ"===N&&(console.log("changed to direct for large amount"),_("DIRECT")),(0,l.useEffect)(()=>{let e=!0;try{e=window!==window.parent;let t=window.location.ancestorOrigins;console.log("%s iniframe: %s, referrer: %s, ancestors: ",window.location.href,e,document.referrer,t)}catch(e){console.log("iframe access blocked")}e&&window.parent.postMessage({type:"pay/checkout_forms/ready"},"*")},[]),(0,l.useEffect)(()=>{let e=p.current;if(!e)return;let t=new ResizeObserver(()=>{y(e.clientHeight)});return t.observe(e),()=>t.disconnect()},[v]),(0,n.jsxs)("div",{ref:f,className:"px-1",style:{pointerEvents:u?"none":"auto"},children:["1"===e&&(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:m("Payment methods")}),(0,n.jsx)("div",{role:"group",className:"mt-2 grid gap-2","aria-label":"Tabs",style:{gridTemplateColumns:"repeat(".concat(function(){let e=Object.keys(v);return e.length<=4?e.length:3}(),", minmax(0, 1fr))")},children:Object.entries(v).map(e=>{let[s,o]=e;return(0,n.jsxs)("button",{type:"button",onClick:()=>{var e;r(s),o.currency?c(o.currency):c("USD"),null===(e=window.top)||void 0===e||e.postMessage({type:"pay-selectedmethod",method:s},"*")},className:a()("col-span-1 min-h-20 flex-1 gap-y-1 rounded-md border border-gray-200 bg-white px-3 py-3 text-left text-sm font-medium shadow-sm hover:bg-gray-50 hover:text-gray-700",{"z-10 text-blue-600 ring-2 ring-blue-600":s===t,"text-gray-500":s!==t}),children:[(0,n.jsx)("div",{className:"mb-1 h-4",children:o.icon}),(0,n.jsx)("div",{className:"text-sm leading-none",children:m(s)})]},s)})})]}),(0,n.jsx)("div",{className:"mt-4 transition-[height] duration-500",style:{height:h},children:(0,n.jsx)("div",{ref:p,children:Object.entries(v).map(e=>{let[r,s]=e;return(0,n.jsx)("div",{className:a()("transition-opacity duration-700",{"opacity-100":r===t,"opacity-0":r!==t}),children:r===t&&(0,n.jsx)(V,{processing:u,setProcessing:d,setMatchedPaymentMethodNeedsLoading:w})},r)})})})]})}},53573:function(e,t,r){r.r(t),r.d(t,{OrderContextProvider:function(){return P},paymentIntentState:function(){return w},useAllPaymentMethods:function(){return A},useCaptureUrl:function(){return S},useLocalAmount:function(){return C},usePaymentIntent:function(){return k},usePricing:function(){return E},useSelectedPaymentMethod:function(){return I}});var n=r(57437),s=r(20703),a=r(2265),o=r(71399),l=r(52840),i=r(21535),c=r(93902),u=r(47907),d=r(32153),m={src:"/_next/static/media/Privat-Bank-01.3b715b1a.svg",height:512,width:512,blurWidth:0,blurHeight:0},p={src:"/_next/static/media/apple_black.bac4af06.svg",height:1e3,width:814,blurWidth:0,blurHeight:0},g={src:"/_next/static/media/eth_color.9e3a1de4.svg",height:533,width:328,blurWidth:0,blurHeight:0},f={src:"/_next/static/media/google_color.f68e49be.svg",height:24,width:24,blurWidth:0,blurHeight:0},h={src:"/_next/static/media/monobank-svgrepo-com.79d9e5dc.svg",height:800,width:800,blurWidth:0,blurHeight:0},y={src:"/_next/static/media/paypal_color.071a8723.svg",height:32,width:101,blurWidth:0,blurHeight:0},x={src:"/_next/static/media/pix_color.db1523b4.svg",height:318,width:899,blurWidth:0,blurHeight:0},v={src:"/_next/static/media/spei.3a887114.svg",height:833,width:2500,blurWidth:0,blurHeight:0},b={src:"/_next/static/media/usdt_color.dcef1ab2.svg",height:295,width:339,blurWidth:0,blurHeight:0};let w=(0,d.cn)({key:"paymentIntentState",default:void 0}),N=(0,a.createContext)({}),_=(0,a.createContext)({}),j=(0,a.createContext)("");function P(e){let{pricing:t,paymentIntent:r,captureToken:s,children:a}=e;return(0,d.Zl)(w)(r),(0,n.jsx)(N.Provider,{value:t,children:(0,n.jsx)(_.Provider,{value:r,children:(0,n.jsx)(j.Provider,{value:s,children:a})})})}function E(){let e=(0,a.useContext)(N);if(!e)throw Error("null 'pricing' in context");return e}function k(){let[e]=(0,d.FV)(w),t=(0,a.useContext)(_);if(e)return e;if(!t)throw Error("null 'paymentIntent' in context");return t}function S(){let e,t;let r=(0,a.useContext)(j);if(!r)throw Error("null 'capturePayload' in context");return e="http://localhost",e=window.location.protocol+"//"+window.location.host,(t=new URL(e)).pathname="/capture",t.searchParams.set("auth",r),t.toString()}function C(){let e=k(),t=(0,i.useForexRate)(),r=e.usd_amount/t;return console.log(r),r}function A(){let e={crypto:{icon:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.eJs,{className:"me-1 inline-block h-full w-auto",color:"#F7BE38"}),(0,n.jsx)(s.default,{src:b,className:"me-1 inline-block h-5/6 w-auto",alt:"USDT"}),(0,n.jsx)(s.default,{src:g,className:"inline-block h-full w-auto",alt:"ETH"})]}),type:"",subscription:!0,country:null},card:{icon:(0,n.jsx)(o.ypE,{className:"h-full w-auto",color:"#070707"}),type:"",subscription:!0,country:null},paypal:{icon:(0,n.jsx)(s.default,{src:y,className:"h-full w-auto",alt:"PayPal (10% fee)"}),type:"",subscription:!0,country:null},googlepay:{icon:(0,n.jsx)(s.default,{src:f,className:"h-full w-auto",alt:"Google Pay"}),type:"wallet",subscription:!0,country:null},applepay:{icon:(0,n.jsx)(s.default,{src:p,className:"h-full w-auto",alt:"Apple Pay"}),type:"wallet",subscription:!0,country:null},alipay:{icon:(0,n.jsx)(o.UZW,{className:"h-full w-auto",color:"#0e9dec"}),type:"",subscription:!0,country:null,currency:"CNY"},wechat:{icon:(0,n.jsx)(l.d1e,{className:"h-full w-auto",color:"#09B83E"}),type:"",subscription:!0,country:null,currency:"CNY"},privatbankandmonobank:{icon:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.default,{src:m,className:"inline-block h-full w-auto",alt:"upi"}),(0,n.jsx)(s.default,{src:h,className:"ml-1 inline-block h-full w-auto",alt:"imps"})]}),type:"paybycurrency",subscription:!0,country:"UA",currency:"UAH"},pix:{icon:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.default,{src:x,className:"inline-block h-full w-auto",alt:"pix"})}),type:"",subscription:!0,country:"BR",currency:"BRL"},spei:{icon:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.default,{src:v,className:"inline-block h-full w-auto",alt:"spei"})}),type:"",subscription:!0,country:"MX",currency:"MXN"}};var t={};let r=k(),{privilege:a}=(0,c.ZP)(),d=!!r.recurring_interval,w=(0,i.useCountry)(),N=(0,u.useSearchParams)();N.get("mo");let _=N.get("ap"),j=N.get("gg"),P=N.get("cd"),E=N.get("pp");for(let[r,n]of Object.entries(e)){if(d&&!n.subscription)continue;let e="";e=window.navigator.userAgent;let s=/Android|iPhone|iPad|iPod/i.test(e);if("applepay"===r){if("DISABLED"===_||!s){console.log("here");continue}t[r]=n}else if("googlepay"===r){if("DISABLED"===j||!s)continue;t[r]=n}else if("card"===r){if("DISABLED"===P||"OVERPAY"===P&&a.last_purchase_amount<1)continue;t[r]=n}else if("paypal"===r){if("DISABLED"===E)continue;t[r]=n}else n.country&&n.country!==w||(t[r]=n)}return t}function I(){let e=(0,u.useSearchParams)().get("selected")||"card";return{...A()[e],key:e}}},21535:function(e,t,r){r.r(t),r.d(t,{default:function(){return l},useCountry:function(){return u},useCurrency:function(){return c},useForexRate:function(){return i}});var n=r(57437),s=r(47907),a=r(2265);let o=(0,a.createContext)({});function l(e){let{forex:t,children:r}=e;return(0,n.jsx)(o.Provider,{value:t,children:r})}function i(){return(0,a.useContext)(o)[c()]}function c(){let e=(0,s.useSearchParams)().get("currency");if(!e)throw Error("null 'currency' in searchparams");return e}function u(){let e=(0,s.useSearchParams)().get("gl");if(!e)throw Error("null 'gl' in searchparams");return e}},93902:function(e,t,r){r.d(t,{FD:function(){return c},ZP:function(){return u}});var n=r(2265),s=r(32153),a=r(15281),o=r(57525);let l=(0,s.cn)({key:"gemscount",default:{PG_GEM_EPHEMERAL:0,PG_GEM_PERMANENT:0}}),i=(0,s.cn)({key:"privilege",default:{last_purchase_amount:0,level:0,level_name:"basic",user_id:void 0}});function c(){let[e,t]=(0,s.FV)(l),[r,c]=(0,s.FV)(i),{userInfo:u}=(0,a.useUserInfo)();return(0,n.useEffect)(()=>{if(!u||!u.userId)return;let e=!1;return o.Z.checkUserGem(u.userId).then(e=>{t({PG_GEM_EPHEMERAL:e.PG_GEM_EPHEMERAL||0,PG_GEM_PERMANENT:e.PG_GEM_PERMANENT||0})}),o.Z.getUserInfo(u.userId).then(t=>{let r="basic",n=0;t.last_purchase_amount>20&&(r="advanced",n=1),t.last_purchase_amount>40&&(r="master",n=2),t.last_purchase_amount>60&&(r="artist",n=3),t.last_purchase_amount>130&&(r="ultimate",n=4),e||c({last_purchase_amount:t.last_purchase_amount,level:n,level_name:r,user_id:t.user_id})}),()=>{e=!0}},[u]),{gemData:e}}function u(){let[e,t]=(0,s.FV)(l),[r,c]=(0,s.FV)(i),{userInfo:u}=(0,a.useUserInfo)();return{gemData:e,refreshGemData:(0,n.useCallback)(()=>{u&&u.userId&&o.Z.checkUserGem(u.userId).then(e=>{t({PG_GEM_EPHEMERAL:e.PG_GEM_EPHEMERAL||0,PG_GEM_PERMANENT:e.PG_GEM_PERMANENT||0})})},[t,u]),privilege:r}}}}]);